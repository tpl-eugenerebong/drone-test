kind: pipeline
type: kubernetes
name: default

platform:
  os: linux
  arch: arm64

metadata:
  namespace: default

steps:
# - name: Test the repository
#   image: node  
#   commands:
#   - npm install
#   - npm test
# - name: Build and Push the repository
#   image: plugins/docker
#   settings:
#     username: 
#       from_secret: docker-user
#     password: 
#       from_secret: docker-pass
#     repo: tpleugenerebong/deploy-test
#     tags: development
- name: Deploy the image
  image: komljen/drone-kubectl-helm
  secrets: [ k8s_server, k8s_cert, k8s_token ]
  kubectl: "get nodes"
  

trigger:
  branch:
    include:
    - master
    - develop
    - feature/*